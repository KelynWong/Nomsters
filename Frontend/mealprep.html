<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">

  <link rel="stylesheet" href="css/master.css">
  <link rel="stylesheet" href="css/home.css">
  <link rel="stylesheet" href="css/mealprep.css">


  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://unpkg.com/vue@next"></script>
</head>

<body>
    
  <div id="app">
    <app-nav :allrecipes="allrecipes" @search="searchRecipes"></app-nav>

    <div class="banner bg-light"> 
        <h2 class="text-center p-4">Meal Prep Generator</h2>
    </div>

    <div class="container col-8">
        <!-- numeric -->
    <div class="row p-5">
        <div class="form-outline col-6 mt-2">
            <label class="form-label" for="typeNumber">Number of Meals per Day</label>
            <input type="number" id="typeNumber" value="mealsPerDay" class="form-control" placeholder="2" min="2" max="5" required/>
            <small class="form-text text-muted">Please enter a number between 2 and 5.</small>
        </div>
        <div class="form-outline col-6 mt-2">
            <label class="form-label" for="typeNumber">Number of Snacks per Day</label>
            <input type="number" id="typeNumber" value="mealsPerDay" class="form-control" placeholder="max 2" max="2"/>
            <small class="form-text text-muted">Please enter a maximum value of 2.</small>
        </div>
        <div class="form-outline col-6 mt-2">
            <label class="form-label" for="typeNumber">Calorie Goal per Day</label>
            <input type="number" id="typeNumber" value="calories" class="form-control" placeholder="3000" max="3500"/>
            <small class="form-text text-muted">Please enter a maximum value of 3500.</small>
        </div>
        <div class="form-outline col-6 mt-2">
            <label class="form-label" for="typeNumber">Protein Intake per Day</label>
            <input type="number" id="typeNumber" value="calories" class="form-control" placeholder="3000"/>
        </div>
        <div class="form-outline col-12 mt-2">
            <label class="form-label" for="typeNumber">Budget per Day ($)</label>
            <input type="number" id="typeNumber" value="budget" class="form-control" placeholder="eg. 12"/>
            <small class="form-text text-muted">Please set a budget of at least $12.</small>
        </div>
    </div>
      
      <div class="text-center">
        <button type="submit" class="btn btn-danger" style="font-weight:lighter">Generate Plan</button>
    </div> 

    </div>
    <br>

    <div class="banner bg-light"> 
        <h2 class="text-center p-4">Generated Meal Plan</h2>
    </div>

    <div class="container col-8 p-4">
        <div class="row">
            <div class="col-4">
              <div class="card">
                <!-- <img src="img/acai.jpeg" class="card-img-top" alt="..."> -->
                <div class="card-body">
                  <h5 class="card-title">Recipe Name</h5>
                  <p class="card-text p-2">~ Description ~</p>
                  <p class="card-text">Nutritional Info:</p>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">Calorie Count</li>
                    <li class="list-group-item">Fat</li>
                    <li class="list-group-item">Protein</li>
                  </ul>
                  <div class="text-center"><a href="#" class="btn btn-danger" style="font-weight:lighter" >Swap Out</a></div>
                </div>
              </div>
            </div>
            
            <div class="col-sm-4">
                <div class="card">
                  <img src="img/kaya_toast.jpeg" class="card-img-top" alt="...">
                  <div class="card-body">
                    <h5 class="card-title">Recipe Name</h5>
                    <p class="card-text p-2">~ Description ~</p>
                    <p class="card-text">Nutritional Info:</p>
                    <ul class="list-group list-group-flush">
                      <li class="list-group-item">Calorie Count</li>
                      <li class="list-group-item">Fat</li>
                      <li class="list-group-item">Protein</li>
                    </ul>
                    <div class="text-center"><a href="#" class="btn btn-danger" style="font-weight:lighter" >Swap Out</a></div>
                  </div>
                </div>
            </div>

            <div class="col-sm-4">
                <div class="card">
                  <img src="img/mains.jpeg" class="card-img-top" alt="...">
                  <div class="card-body">
                    <h5 class="card-title">Recipe Name</h5>
                    <p class="card-text p-2">~ Description ~</p>
                    <p class="card-text">Nutritional Info:</p>
                    <ul class="list-group list-group-flush">
                      <li class="list-group-item">Calorie Count</li>
                      <li class="list-group-item">Fat</li>
                      <li class="list-group-item">Protein</li>
                    </ul>
                    <div class="text-center"><a href="#" class="btn btn-danger" style="font-weight:lighter" >Swap Out</a></div>
                  </div>
                </div>
            </div>
        </div>
    </div>

    <div class="banner bg-light"> 
        <h2 class="text-center p-4">Consolidated Stats:</h2>
    </div>
    
    <div class="container col-4 p-4">
        <div class="card">
            <div class="card-header">
              Total Calories (per day) - 9999
            </div>
            <ul class="list-group list-group-flush">
              <li class="list-group-item">Fat - 213</li>
              <li class="list-group-item">Protein - 213</li>
              <li class="list-group-item">Cost per day - $987</li>
            </ul>
          </div>

    </div>
    
    
      
    <app-footer></app-footer>
    
  </div>


  <!-- Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

  <script src="component/navbar.js"></script>
  <script src="component/listing.js"></script>
  <script src="component/footer.js"></script>

  <script>
    const app = Vue.createApp({
      components: {
        'app-footer': footer,
      },
      data() {
        return {
          allrecipes: []
        };
      },
      mounted() {
        this.fetchAllRecipes();
      },
      methods: {
        searchRecipes(titleQuery){
            window.location.href = `allRecipe.html?search=${titleQuery}`;
        },
        fetchAllRecipes(){
            axios.get('https://leaptron2.dscloud.me:3000/api/recipe', {
                headers:{
                    Authorization: "BEARER eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImlhdCI6MTY5ODA0MzIwNCwiZXhwIjoxNjk4MTI5NjA0fQ.C5O7wzyWIo-1vGPBPGHtDyOTMVBvtReAZL9NKKJsOaw"
                }
            }).then(response => {
                console.log(response.data)
                this.allrecipes = response.data
                console.log(this.allrecipes)
            }).catch( error => {
                console.log(error.response.data.message);
                this.errorMessage = error.response.data.message;
                this.allrecipes = [];
                this.isError = true;
            });
        },
      }
    });
    
    app.component('app-nav', {
      data() {
          return {
              showIsActive: false,
              random: []
          }
      },
      props: {
          allrecipes: {
              type: Array,
              required: true
          },
          size: {
              type: Number,
              required: false,
              default: 12
          }
      },
      methods: {
          showHideModal() {
              this.showIsActive = !this.showIsActive;

              this.generateRandomRecipe();
          },
          generateRandomRecipe() {
              if (this.allrecipes.length > 0) {
                  const length = this.allrecipes.length;
                  const r = this.allrecipes[Math.floor(Math.random() * length)];
      
                  console.log(this.random);
                  this.random = r;
              }
          },
          closeModal() {
              this.showIsActive = !this.showIsActive;
          },
      },
      template: navbar.template + `
          <div class="random-recipe" :class="{active: showIsActive}">
              <div class="overlay" @click="closeModal"></div>
              <div class="modal-box">
                  <h3>Random Recipe Generator</h3>
                  ${listing.single}
                  <div class="buttons">
                      <!-- <button class="btn close-btn" @click="showHideModal">Close</button> -->
                      <button class="btn decide-btn generate" @click="generateRandomRecipe">Regenerate</button>
                      <button class="btn decide-btn generate"><a href="recipeDetail.html?">Go to Recipe</a></button>
                  </div>
              </div>
          </div>
        `,
    });

    app.component('app-listing', listing);

    app.mount('#app');

    gsap.from("#countRecipe", {
      textContent: 0,
      duration: 4,
      ease: "power1.in",
      snap: { textContent: 1 }
    });

    const buttons = document.querySelectorAll(".topRecipe");

    buttons.forEach(function (button) {
      button.addEventListener("click", function () {
        buttons.forEach(function (btn) {
          btn.classList.remove("btn-danger");
          btn.classList.add("btn-outline-secondary");

          var rmv = document.getElementById(btn.getAttribute("data-value"));
          rmv.style.display = 'none';
        });

        var content = document.getElementById(event.target.getAttribute("data-value"));
        content.style.display = 'block';
      });
    });

  </script>
</body>

</html>